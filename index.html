<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes">
    <title>Mantenimiento Waldorf Â· Jornada 9-15</title>
    <!-- Google Sheets como BD compartida (lectura) + Apps Script (escritura) -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        /* ESTILO WALDORF Â· MOBILE FIRST */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #faf4e9;
            font-family: 'Atkinson Hyperlegible', 'Segoe UI', Roboto, -apple-system, sans-serif;
            line-height: 1.5;
            color: #3e2e23;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .waldorf-wrapper {
            max-width: 900px;
            width: 100%;
        }

        h1 {
            font-size: 2.2rem;
            font-weight: 400;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #5e4b3a;
            border-bottom: 4px solid #dbb88c;
            display: inline-block;
            padding-bottom: 0.2rem;
            margin-bottom: 1.5rem;
            margin-top: 0.2rem;
            text-shadow: 2px 2px 0 rgba(235, 205, 167, 0.3);
            word-break: break-word;
        }

        .area {
            background: rgba(255, 247, 240, 0.8);
            border-radius: 32px 12px 32px 12px;
            padding: 1.5rem 1.2rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 18px -6px rgba(120, 90, 70, 0.12);
            border: 1px solid #e6d8c5;
        }

        h2 {
            font-size: 1.8rem;
            font-weight: 380;
            color: #7a5a44;
            margin-bottom: 0.6rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-left: 12px solid #c7aa82;
            padding-left: 0.75rem;
            line-height: 1.2;
        }

        .subtitulo-detalle {
            font-size: 0.95rem;
            font-weight: 400;
            color: #8f6e5c;
            margin-top: -0.2rem;
            margin-bottom: 1.2rem;
            padding-left: 1.2rem;
            font-style: italic;
            border-left: 3px solid #e2cfbc;
        }

        .task-list {
            display: flex;
            flex-direction: column;
            gap: 1.3rem;
        }

        .task-item {
            background: #fffefc;
            padding: 1.1rem 1.2rem;
            border-radius: 20px 8px 20px 8px;
            border: 1px solid #eedccb;
            box-shadow: 4px 4px 0 #e2cfbc;
        }

        .task-name {
            font-weight: 650;
            font-size: 1.15rem;
            color: #4a3729;
            display: block;
            margin-bottom: 0.8rem;
            border-bottom: 1px dashed #d9b8a4;
            padding-bottom: 0.5rem;
        }

        .contribution-form {
            display: flex;
            flex-direction: column;
            gap: 0.7rem;
            margin: 0.8rem 0 0.6rem;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.4rem 0.8rem;
        }

        label {
            font-size: 0.9rem;
            color: #69554a;
            font-weight: 600;
            min-width: 60px;
        }

        input {
            background: #fefcf7;
            border: 1.5px solid #e3cebc;
            border-radius: 40px;
            padding: 0.7rem 1.1rem;
            font-size: 1rem;
            flex: 1 1 180px;
            font-family: inherit;
            transition: 0.2s;
        }

        input:focus {
            border-color: #b4835c;
            outline: none;
            background-color: #fff9f2;
            box-shadow: 0 0 0 3px rgba(180, 140, 100, 0.15);
        }

        .btn {
            background: #ebdac9;
            border: none;
            border-radius: 50px;
            padding: 0.7rem 1.5rem;
            font-size: 0.95rem;
            font-weight: 600;
            color: #3a2e25;
            border-bottom: 4px solid #bcaa96;
            align-self: flex-start;
            transition: 0.07s;
            letter-spacing: 0.5px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e5cfbc;
            border-bottom-width: 4px;
        }

        .btn:hover {
            background: #e2cfbc;
            border-bottom-width: 2px;
            transform: translateY(2px);
            border-bottom-color: #9f8b7a;
        }

        .contributors-wall {
            margin-top: 1.2rem;
            background: #f7efe7;
            padding: 1rem 1.2rem;
            border-radius: 18px;
            border-left: 8px solid #c6a882;
            font-size: 0.95rem;
        }

        .wall-title {
            font-weight: 650;
            color: #624c3c;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 0.7rem;
            font-size: 1rem;
        }

        .participant-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .participant-list li {
            background: white;
            padding: 0.45rem 1.2rem;
            border-radius: 30px;
            border: 1px solid #eddacb;
            color: #4d3a2e;
            display: inline-block;
            width: fit-content;
            max-width: 100%;
            word-break: break-word;
            box-shadow: 1px 2px 0 #dac2b0;
        }

        .empty-message {
            color: #957a68;
            font-style: italic;
            padding: 0.3rem 0;
        }

        @media (min-width: 640px) {
            body { padding: 2rem; }
            .waldorf-wrapper { max-width: 1100px; }
            .form-row { flex-wrap: nowrap; }
        }

        .connection-status {
            font-size: 0.8rem;
            padding: 0.5rem 1.2rem;
            background: #eedccb;
            border-radius: 40px;
            display: inline-block;
            margin-bottom: 1rem;
            color: #4a3a2e;
        }

        footer {
            margin-top: 2rem;
            font-size: 0.85rem;
            color: #8f7a68;
            text-align: center;
            border-top: 1px dashed #dac2af;
            padding-top: 1.8rem;
        }
        hr {
            border: none;
            border-top: 2px dotted #dbb88c;
            margin: 1.2rem 0;
        }
        .nota-jornada {
            background: #ecdcc9;
            padding: 0.6rem 1.2rem;
            border-radius: 50px;
            display: inline-block;
            margin-bottom: 0.8rem;
            font-weight: 500;
            color: #4a3729;
        }
    </style>
</head>
<body>
    <div class="waldorf-wrapper">
        <h1>MANTENIMIENTOS</h1>
        <div class="connection-status" id="status-message">
            ğŸŒ± Conectando al mural comunitario...
        </div>

        <!-- =========== PRIMARIA Â· Materiales y herramientas =========== -->
        <section class="area">
            <h2>ğŸ“˜ Primaria</h2>
            <div class="subtitulo-detalle">
                Lista de materiales y herramientas necesarias para las jornadas Â· maÃ±ana de 9 a 15
            </div>
            <div class="task-list">
                <!-- Tarea 1 Primaria -->
                <div class="task-item" data-tarea-id="prim1">
                    <span class="task-name">ğŸ”¨ Percutora para sacar piso</span>
                    <div class="contribution-form">
                        <div class="form-row"><label>Nombre</label><input type="text" id="nombre-prim1" placeholder="quiÃ©n lleva/trae"></div>
                        <div class="form-row"><label>Grado</label><input type="text" id="grado-prim1" placeholder="familia / docente"></div>
                        <button class="btn" onclick="agregarColaborador('prim1', 'Percutora para sacar piso')">ğŸŒ¿ Me sumo</button>
                    </div>
                    <div class="contributors-wall" id="wall-prim1"><span class="wall-title">ğŸ‘¥ Colaboran:</span><ul class="participant-list" id="list-prim1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <!-- Tarea 2 Primaria -->
                <div class="task-item" data-tarea-id="prim2">
                    <span class="task-name">ğŸŒ¿ Herramientas de jardinerÃ­a</span>
                    <div class="contribution-form">
                        <div class="form-row"><label>Nombre</label><input type="text" id="nombre-prim2" placeholder="quiÃ©n lleva"></div>
                        <div class="form-row"><label>Grado</label><input type="text" id="grado-prim2" placeholder="grado/familia"></div>
                        <button class="btn" onclick="agregarColaborador('prim2', 'Herramientas de jardinerÃ­a')">ğŸŒ¿ Me sumo</button>
                    </div>
                    <div class="contributors-wall" id="wall-prim2"><span class="wall-title">ğŸ‘¥ Colaboran:</span><ul class="participant-list" id="list-prim2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <!-- Tarea 3 Primaria -->
                <div class="task-item" data-tarea-id="prim3">
                    <span class="task-name">ğŸ”© Taladro</span>
                    <div class="contribution-form">
                        <div class="form-row"><label>Nombre</label><input type="text" id="nombre-prim3" placeholder="quiÃ©n acerca"></div>
                        <div class="form-row"><label>Grado</label><input type="text" id="grado-prim3" placeholder="grado"></div>
                        <button class="btn" onclick="agregarColaborador('prim3', 'Taladro')">ğŸŒ¿ Me sumo</button>
                    </div>
                    <div class="contributors-wall" id="wall-prim3"><span class="wall-title">ğŸ‘¥ Colaboran:</span><ul class="participant-list" id="list-prim3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <!-- Tarea 4 Primaria -->
                <div class="task-item" data-tarea-id="prim4">
                    <span class="task-name">ğŸ“¦ Cinta doble faz 3M (40mts) para colgar cuadros</span>
                    <div class="contribution-form">
                        <div class="form-row"><label>Nombre</label><input type="text" id="nombre-prim4" placeholder="quiÃ©n aporta"></div>
                        <div class="form-row"><label>Grado</label><input type="text" id="grado-prim4" placeholder="grado"></div>
                        <button class="btn" onclick="agregarColaborador('prim4', 'Cinta doble faz 40m')">ğŸŒ¿ Me sumo</button>
                    </div>
                    <div class="contributors-wall" id="wall-prim4"><span class="wall-title">ğŸ‘¥ Colaboran:</span><ul class="participant-list" id="list-prim4"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <!-- =========== JARDÃN Â· Materiales =========== -->
        <section class="area">
            <h2>ğŸŒ¼ JardÃ­n Â· Materiales</h2>
            <div class="subtitulo-detalle">
                Lista de materiales jardÃ­n
            </div>
            <div class="task-list">
                <div class="task-item" data-tarea-id="jard-mat1"><span class="task-name">ğŸªµ Protectores para calefactores (listones de pino)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat1"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat1"></div><button class="btn" onclick="agregarColaborador('jard-mat1', 'Protectores calefactores listones')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat1"><ul class="participant-list" id="list-jard-mat1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat2"><span class="task-name">ğŸ›¡ï¸ Cobertor para arenero de jardÃ­n y maternal</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat2"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat2"></div><button class="btn" onclick="agregarColaborador('jard-mat2', 'Cobertor arenero jardÃ­n/maternal')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat2"><ul class="participant-list" id="list-jard-mat2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat3"><span class="task-name">ğŸšª Puerta de madera para cocina</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat3"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat3"></div><button class="btn" onclick="agregarColaborador('jard-mat3', 'Puerta cocina madera')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat3"><ul class="participant-list" id="list-jard-mat3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat4"><span class="task-name">â˜€ï¸ Estructura y policarbonato para alero de preescolar</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat4"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat4"></div><button class="btn" onclick="agregarColaborador('jard-mat4', 'Estructura policarbonato alero')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat4"><ul class="participant-list" id="list-jard-mat4"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat5"><span class="task-name">ğŸ§» Dispenser acero inoxidable para toallas papel (x2 baÃ±os)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat5"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat5"></div><button class="btn" onclick="agregarColaborador('jard-mat5', 'Dispenser toallas acero x2')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat5"><ul class="participant-list" id="list-jard-mat5"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat6"><span class="task-name">ğŸ§» Dispenser acero inoxidable papel higiÃ©nico (x3 baÃ±os)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat6"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat6"></div><button class="btn" onclick="agregarColaborador('jard-mat6', 'Dispenser papel hig x3')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat6"><ul class="participant-list" id="list-jard-mat6"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat7"><span class="task-name">ğŸ“ Cinta doble faz para pegar alfombra</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat7"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat7"></div><button class="btn" onclick="agregarColaborador('jard-mat7', 'Cinta doble faz alfombra')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat7"><ul class="participant-list" id="list-jard-mat7"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-mat8"><span class="task-name">ğŸ¢ Tortuguita exterior para reponer (puerta sala de Ana)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-mat8"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-mat8"></div><button class="btn" onclick="agregarColaborador('jard-mat8', 'Tortuguita exterior')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-mat8"><ul class="participant-list" id="list-jard-mat8"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <!-- =========== MATERNAL Â· Pendientes a finalizar (9 a 15) =========== -->
        <section class="area">
            <h2>ğŸ¼ Maternal</h2>
            <div class="subtitulo-detalle">
                Lista de pendientes a finalizar Â· maÃ±ana 9 a 15
            </div>
            <div class="task-list">
                <div class="task-item" data-tarea-id="mat1"><span class="task-name">ğŸ  Nivelar casita exterior</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-mat1"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-mat1"></div><button class="btn" onclick="agregarColaborador('mat1', 'Nivelar casita exterior')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-mat1"><ul class="participant-list" id="list-mat1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="mat2"><span class="task-name">ğŸ§· Pegar alfombra (cinta doble faz)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-mat2"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-mat2"></div><button class="btn" onclick="agregarColaborador('mat2', 'Pegar alfombra cinta')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-mat2"><ul class="participant-list" id="list-mat2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="mat3"><span class="task-name">ğŸªŸ Poner protectores en ventanas</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-mat3"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-mat3"></div><button class="btn" onclick="agregarColaborador('mat3', 'Protectores ventanas')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-mat3"><ul class="participant-list" id="list-mat3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <!-- =========== JARDÃN Â· Pendientes a finalizar (9 a 15) =========== -->
        <section class="area">
            <h2>ğŸŒ± JardÃ­n Â· Pendientes</h2>
            <div class="subtitulo-detalle">
                Lista de pendientes a finalizar Â· maÃ±ana 9 a 15
            </div>
            <div class="task-list">
                <div class="task-item" data-tarea-id="jard-pen1"><span class="task-name">ğŸ§± Colocar azulejos sala Ana</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen1"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen1"></div><button class="btn" onclick="agregarColaborador('jard-pen1', 'Colocar azulejos sala Ana')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen1"><ul class="participant-list" id="list-jard-pen1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen2"><span class="task-name">ğŸªµ Lijar tobogÃ¡n chico de mangrullo (masilla)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen2"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen2"></div><button class="btn" onclick="agregarColaborador('jard-pen2', 'Lijar tobogÃ¡n mangrullo')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen2"><ul class="participant-list" id="list-jard-pen2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen3"><span class="task-name">ğŸ¨ Segunda mano de cetol a mangrullo</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen3"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen3"></div><button class="btn" onclick="agregarColaborador('jard-pen3', 'Cetol mangrullo 2da mano')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen3"><ul class="participant-list" id="list-jard-pen3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen4"><span class="task-name">ğŸ”© Cortar tornillos hamaca + esmalte sintÃ©tico</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen4"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen4"></div><button class="btn" onclick="agregarColaborador('jard-pen4', 'Cortar tornillos hamaca')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen4"><ul class="participant-list" id="list-jard-pen4"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen5"><span class="task-name">ğŸ–ï¸ Agregar arena a areneros</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen5"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen5"></div><button class="btn" onclick="agregarColaborador('jard-pen5', 'Agregar arena areneros')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen5"><ul class="participant-list" id="list-jard-pen5"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen6"><span class="task-name">ğŸ› ï¸ Hacer cobertores para areneros</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen6"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen6"></div><button class="btn" onclick="agregarColaborador('jard-pen6', 'Cobertores areneros')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen6"><ul class="participant-list" id="list-jard-pen6"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="jard-pen7"><span class="task-name">ğŸ¡ Aplicar cetol a la casita sala Ceci</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-jard-pen7"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-jard-pen7"></div><button class="btn" onclick="agregarColaborador('jard-pen7', 'Cetol casita Ceci')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-jard-pen7"><ul class="participant-list" id="list-jard-pen7"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <!-- =========== PREESCOLAR Â· Pendientes =========== -->
        <section class="area">
            <h2>ğŸ¨ Preescolar</h2>
            <div class="subtitulo-detalle">
                Lista de pendientes a finalizar Â· maÃ±ana 9 a 15
            </div>
            <div class="task-list">
                <div class="task-item" data-tarea-id="pre1"><span class="task-name">ğŸ”¥ Hacer protector para calefactor</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-pre1"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-pre1"></div><button class="btn" onclick="agregarColaborador('pre1', 'Protector calefactor')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-pre1"><ul class="participant-list" id="list-pre1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="pre2"><span class="task-name">ğŸšª Terminar de lijar y pintar puerta de baÃ±o</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-pre2"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-pre2"></div><button class="btn" onclick="agregarColaborador('pre2', 'Lijar y pintar puerta baÃ±o')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-pre2"><ul class="participant-list" id="list-pre2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="pre3"><span class="task-name">ğŸª‘ Lijar dos mesas y aplicar cetol</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-pre3"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-pre3"></div><button class="btn" onclick="agregarColaborador('pre3', 'Lijar mesas cetol')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-pre3"><ul class="participant-list" id="list-pre3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="pre4"><span class="task-name">ğŸ  Lijar y aplicar cetol a casita</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-pre4"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-pre4"></div><button class="btn" onclick="agregarColaborador('pre4', 'Lijar y cetol casita')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-pre4"><ul class="participant-list" id="list-pre4"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <!-- =========== GENERAL Â· Pendientes =========== -->
        <section class="area">
            <h2>ğŸ› ï¸ General</h2>
            <div class="subtitulo-detalle">
                Lista de pendientes a finalizar
            </div>
            <div class="task-list">
                <div class="task-item" data-tarea-id="gen1"><span class="task-name">ğŸš½ Instalar mingitorio</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-gen1"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-gen1"></div><button class="btn" onclick="agregarColaborador('gen1', 'Instalar mingitorio')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-gen1"><ul class="participant-list" id="list-gen1"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="gen2"><span class="task-name">ğŸ”¥ Arreglar protectores de calefactores</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-gen2"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-gen2"></div><button class="btn" onclick="agregarColaborador('gen2', 'Arreglar protectores calefactores')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-gen2"><ul class="participant-list" id="list-gen2"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="gen3"><span class="task-name">ğŸšª Conseguir puerta para cocina y colocarla</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-gen3"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-gen3"></div><button class="btn" onclick="agregarColaborador('gen3', 'Puerta cocina y colocar')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-gen3"><ul class="participant-list" id="list-gen3"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="gen4"><span class="task-name">ğŸš½ Cambiar tapa inodoros pequeÃ±os (comprar)</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-gen4"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-gen4"></div><button class="btn" onclick="agregarColaborador('gen4', 'Comprar/cambiar tapa inodoros')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-gen4"><ul class="participant-list" id="list-gen4"><li class="empty-message">Cargando...</li></ul></div>
                </div>
                <div class="task-item" data-tarea-id="gen5"><span class="task-name">ğŸ§º Comprar cambiador para baÃ±o y colocarlo</span>
                    <div class="contribution-form"><div class="form-row"><label>Nombre</label><input type="text" id="nombre-gen5"></div><div class="form-row"><label>Grado</label><input type="text" id="grado-gen5"></div><button class="btn" onclick="agregarColaborador('gen5', 'Cambiador baÃ±o')">ğŸŒ¿ Me sumo</button></div>
                    <div class="contributors-wall" id="wall-gen5"><ul class="participant-list" id="list-gen5"><li class="empty-message">Cargando...</li></ul></div>
                </div>
            </div>
        </section>

        <footer>
            ğŸŒŸ Jornada Waldorf 
        </footer>
    </div>

    <script>
        // --------------------------------------------------------------
        // GOOGLE SHEETS - CONFIGURACIÃ“N (REEMPLAZA CON TU URL PUBLICADA)
        // --------------------------------------------------------------
        const SHEETS_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSy_-NUphj4b2DXs07sbazX4P1uAAHrkS72Q665tbLBIxt680pASLn2QU4zUNE95Yvo3W4KR2f9K0pu/pub?gid=0&single=true&output=csv'; // CAMBIA ESTO
        
        // Estado de datos compartidos
        let datosColaboraciones = {};
        const TAREAS = [
            'prim1','prim2','prim3','prim4',
            'jard-mat1','jard-mat2','jard-mat3','jard-mat4','jard-mat5','jard-mat6','jard-mat7','jard-mat8',
            'mat1','mat2','mat3',
            'jard-pen1','jard-pen2','jard-pen3','jard-pen4','jard-pen5','jard-pen6','jard-pen7',
            'pre1','pre2','pre3','pre4',
            'gen1','gen2','gen3','gen4','gen5'
        ];

        const statusMsg = document.getElementById('status-message');

        // Inicializar estructura
        TAREAS.forEach(t => datosColaboraciones[t] = []);

        // Cargar desde Google Sheets CSV
        async function cargarGoogleSheets() {
            try {
                const response = await fetch(SHEETS_URL);
                const csv = await response.text();
                const lineas = csv.split('\n');
                
                // Reiniciar datos
                TAREAS.forEach(t => datosColaboraciones[t] = []);
                
                for (let i = 1; i < lineas.length; i++) {
                    if (!lineas[i].trim()) continue;
                    // Manejo bÃ¡sico CSV (sin comas dentro de campos)
                    const partes = lineas[i].split(',');
                    if (partes.length >= 3) {
                        const tareaId = partes[0].replace(/"/g, '').trim();
                        const nombre = partes[1].replace(/"/g, '').trim();
                        const grado = partes[2].replace(/"/g, '').trim();
                        if (TAREAS.includes(tareaId)) {
                            datosColaboraciones[tareaId].push({ nombre, grado });
                        }
                    }
                }
                statusMsg.textContent = 'ğŸŒ¿ Conectado Â· mural comunitario (Google Sheets)';
                statusMsg.style.background = '#d1e0d2';
            } catch (e) {
                console.warn('Error leyendo Google Sheets, usamos localStorage:', e);
                cargarDeLocalStorage();
                statusMsg.textContent = 'ğŸŒ± Modo offline Â· datos locales (compartidos en este dispositivo)';
                statusMsg.style.background = '#eedccb';
            }
            // Renderizar todas
            TAREAS.forEach(tareaId => renderizarMuro(tareaId));
        }

        function cargarDeLocalStorage() {
            const stored = localStorage.getItem('waldorf_jornada');
            if (stored) {
                try { datosColaboraciones = JSON.parse(stored); } catch(e){}
            }
            TAREAS.forEach(t => { if (!datosColaboraciones[t]) datosColaboraciones[t] = []; });
        }

        function guardarEnLocalStorage() {
            localStorage.setItem('waldorf_jornada', JSON.stringify(datosColaboraciones));
        }

        function renderizarMuro(tareaId) {
            const listaUl = document.getElementById(`list-${tareaId}`);
            if (!listaUl) return;
            const participantes = datosColaboraciones[tareaId] || [];
            listaUl.innerHTML = '';
            if (participantes.length === 0) {
                const emptyLi = document.createElement('li');
                emptyLi.className = 'empty-message';
                emptyLi.textContent = 'AÃºn sin voluntades Â· animate';
                listaUl.appendChild(emptyLi);
            } else {
                // Ãºltimos 5
                const ultimos = participantes.slice(-5).reverse();
                ultimos.forEach(p => {
                    const li = document.createElement('li');
                    li.textContent = `${p.nombre || 'Voluntario'} Â· ${p.grado || 'grado'}`;
                    listaUl.appendChild(li);
                });
                if (participantes.length > 5) {
                    const li = document.createElement('li');
                    li.textContent = `... y ${participantes.length - 5} mÃ¡s`;
                    li.style.background = '#f3ede7';
                    listaUl.appendChild(li);
                }
            }
        }

        // FunciÃ³n global para agregar
        window.agregarColaborador = function(tareaId, descripcion) {
            const nombreInput = document.getElementById(`nombre-${tareaId}`);
            const gradoInput = document.getElementById(`grado-${tareaId}`);
            
            let nombre = nombreInput ? nombreInput.value.trim() : '';
            let grado = gradoInput ? gradoInput.value.trim() : '';
            
            if (nombre === '' && grado === '') {
                alert('ğŸ‘‹ Escribe tu nombre o grado para sumarte');
                return;
            }
            if (nombre === '') nombre = 'Voluntario/a';
            if (grado === '') grado = 'â€”';
            
            if (!datosColaboraciones[tareaId]) datosColaboraciones[tareaId] = [];
            datosColaboraciones[tareaId].push({ nombre, grado });
            
            guardarEnLocalStorage();
            renderizarMuro(tareaId);
            
            // Limpiar
            if (nombreInput) nombreInput.value = '';
            if (gradoInput) gradoInput.value = '';
            
            statusMsg.textContent = 'âœ¨ Â¡Gracias por sumarte a la jornada!';
            setTimeout(() => { statusMsg.textContent = 'ğŸŒ¿ Conectado Â· mural comunitario'; }, 2000);
            
            // AcÃ¡ podrÃ­as llamar a tu Apps Script para escribir en Google Sheets
            // enviarAGoogleSheets(tareaId, nombre, grado);
        };

        window.onload = () => {
            cargarGoogleSheets();
            // Escuchar cambios en localStorage (misma compu, diferentes pestaÃ±as)
            window.addEventListener('storage', (e) => {
                if (e.key === 'waldorf_jornada') {
                    cargarDeLocalStorage();
                    TAREAS.forEach(t => renderizarMuro(t));
                }
            });
        };
    </script>
    <!-- Instrucciones breves para conectar Google Sheets real -->
    <div style="font-size:0.75rem; color:#8f7a68; margin-top:0.5rem; padding:0.8rem; background:#f3ede7; border-radius:16px;">
        <strong>ğŸŒ Para compartir en todas las computadoras:</strong> ReemplazÃ¡ SHEETS_URL con tu CSV pÃºblico de Google Sheets. 
        Ver guÃ­a paso a paso. Mientras tanto, los datos se comparten en este navegador.
    </div>
</body>
</html>
